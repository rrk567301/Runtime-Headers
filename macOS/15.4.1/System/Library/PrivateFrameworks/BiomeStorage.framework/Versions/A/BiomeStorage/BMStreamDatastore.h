@class NSString, BMSegmentManager, BMPruningPolicy, BMStreamMetadata, BMStoreConfig, BMFileManager, BMFrameStore;
@protocol BMStreamDatastorePruningDelegate;

@interface BMStreamDatastore : NSObject <BMSegmentManagerDelegate, BMFileManagerDelegate> {
    BMFileManager *_fileManager;
    BMStreamMetadata *_metadata;
    Class _eventDataClass;
    struct os_unfair_lock_s { unsigned int _os_unfair_lock_opaque; } _lock;
    BOOL _biomeLibrary;
    BMStreamDatastore *_tombstoneStore;
    NSString *_useCase;
}

@property (readonly, nonatomic) BMFrameStore *currentFrameStore;
@property (readonly, nonatomic) unsigned long long permission;
@property (readonly, nonatomic) unsigned long long maxFileSize;
@property (readonly, nonatomic) NSString *streamPath;
@property (readonly, nonatomic) NSString *segmentDirectory;
@property (readonly, nonatomic) BMPruningPolicy *pruningPolicy;
@property (readonly, nonatomic) BMSegmentManager *segmentManager;
@property (readonly, copy, nonatomic) NSString *streamId;
@property (readonly, nonatomic) BOOL isDataAccessible;
@property (readonly, nonatomic) BMStreamMetadata *metadata;
@property (readonly, nonatomic) BMStoreConfig *config;
@property (weak, nonatomic) id<BMStreamDatastorePruningDelegate> delegate;
@property (readonly, nonatomic) BOOL includeTombstones;
@property (readonly) unsigned long long hash;
@property (readonly) Class superclass;
@property (readonly, copy) NSString *description;
@property (readonly, copy) NSString *debugDescription;

- (void).cxx_destruct;
- (BOOL)updateMetadata:(Class)a0;
- (long long)cachingOptionsForFileHandleWithAttributes:(id)a0;
- (BOOL)deleteEventAtBookmark:(id)a0 outTombstoneBookmark:(id *)a1;
- (int)frameCountInStreamDataStoreFromSegmentsContainingTime:(double)a0 to:(double)a1;
- (id)initWithStream:(id)a0 permission:(unsigned long long)a1 config:(id)a2 includeTombstones:(BOOL)a3;
- (id)initWithStream:(id)a0 permission:(unsigned long long)a1 config:(id)a2 includeTombstones:(BOOL)a3 eventDataClass:(Class)a4 useCase:(id)a5;
- (id)newEnumeratorFromBookmark:(id)a0;
- (id)newEnumeratorFromBookmarkEnumerator:(id)a0 error:(id *)a1;
- (id)newEnumeratorFromStartTime:(double)a0 endTime:(double)a1 maxEvents:(unsigned long long)a2 lastN:(unsigned long long)a3 options:(unsigned long long)a4;
- (void)pruneStreamToMaxStreamSizeInBytes:(unsigned long long)a0;
- (BOOL)writeEventWithEventBody:(id)a0 timestamp:(double)a1 outEventSize:(unsigned long long *)a2;
- (void)syncMappedFiles;
- (id)_bookmarkWithSegmentName:(id)a0 offset:(unsigned long long)a1 datastoreVersion:(unsigned int)a2;
- (void)_removeEventsFrom:(double)a0 to:(double)a1 reason:(unsigned long long)a2 policyID:(id)a3 pruneFutureEvents:(BOOL)a4 shouldDeleteUsingBlock:(id /* block */)a5;
- (void)didMarkFrameAsRemovedWithSegmentName:(id)a0 frame:(id)a1 reason:(unsigned long long)a2 policyID:(id)a3 outTombstoneBookmark:(id *)a4;
- (void)enumerateEventsFrom:(double)a0 to:(double)a1 options:(unsigned long long)a2 usingBlock:(id /* block */)a3;
- (Class)eventBodyClass;
- (void)eventsFrom:(double)a0 to:(double)a1 reason:(unsigned long long)a2 shouldDeleteUsingBlock:(id /* block */)a3;
- (void)fetchEventFromFrameStore:(id)a0 atOffset:(unsigned long long)a1 withOptions:(unsigned long long)a2 callback:(id /* block */)a3;
- (id)fetchEventsFrom:(double)a0 to:(double)a1;
- (id)fetchEventsFrom:(double)a0 to:(double)a1 options:(unsigned long long)a2;
- (int)frameCountInStreamDataStoreFromTime:(double)a0 to:(double)a1;
- (id)initWithStream:(id)a0 permission:(unsigned long long)a1 config:(id)a2;
- (id)initWithStream:(id)a0 streamPath:(id)a1 permission:(unsigned long long)a2 config:(id)a3;
- (id)initWithStream:(id)a0 streamPath:(id)a1 permission:(unsigned long long)a2 config:(id)a3 eventDataClass:(Class)a4 useCase:(id)a5;
- (id)initWithStream:(id)a0 streamPath:(id)a1 permission:(unsigned long long)a2 config:(id)a3 includeTombstones:(BOOL)a4 eventDataClass:(Class)a5 useCase:(id)a6;
- (BOOL)isSubscriptionStore;
- (BOOL)isTombstoneStore;
- (id)loadMetadata;
- (id)metadataPath;
- (id)newEnumeratorFromBookmark:(id)a0 options:(unsigned long long)a1;
- (id)newEnumeratorFromBookmark:(id)a0 options:(unsigned long long)a1 error:(id *)a2;
- (id)newEnumeratorFromStartTime:(double)a0;
- (id)newEnumeratorFromStartTime:(double)a0 endTime:(double)a1 maxEvents:(unsigned long long)a2 options:(unsigned long long)a3;
- (id)newEnumeratorFromStartTime:(double)a0 endTime:(double)a1 options:(unsigned long long)a2;
- (id)newEnumeratorFromStartTime:(double)a0 options:(unsigned long long)a1;
- (id)newTombstoneEnumeratorFromBookmark:(id)a0;
- (id)newTombstoneEnumeratorFromStartTime:(double)a0;
- (void)pruneStreamToMaxSegmentAge:(double)a0;
- (void)removeEventsFrom:(double)a0 to:(double)a1 reason:(unsigned long long)a2 policyID:(id)a3 shouldDeleteUsingBlock:(id /* block */)a4;
- (void)removeEventsFrom:(double)a0 to:(double)a1 reason:(unsigned long long)a2 pruneFutureEvents:(BOOL)a3 shouldDeleteUsingBlock:(id /* block */)a4;
- (void)removeEventsFrom:(double)a0 to:(double)a1 reason:(unsigned long long)a2 pruneFutureEvents:(BOOL)a3 usingBlock:(id /* block */)a4;
- (BOOL)saveMetadata:(id)a0;
- (id)segmentContainingTimestamp:(double)a0;
- (void)segmentManager:(id)a0 willDeleteSegmentName:(id)a1 frameStore:(id)a2;
- (id)segmentNames;
- (id)segmentWithFilename:(id)a0 error:(id *)a1;
- (double)timestampFromSegmentName:(id)a0;
- (id)tombstoneStore;
- (BOOL)updateMetadata:(Class)a0 pruningPolicy:(id)a1;
- (BOOL)updatePruningPolicy:(id)a0;
- (BOOL)verifyStreamHealthFrom:(double)a0 to:(double)a1 error:(id *)a2;
- (BOOL)verifyStreamHealthFromV1:(double)a0 to:(double)a1 frameStore:(id)a2 error:(id *)a3;
- (BOOL)verifyStreamHealthFromV2:(double)a0 to:(double)a1 frameStore:(id)a2 error:(id *)a3;
- (BOOL)writeEventBytes:(const void *)a0 length:(unsigned long long)a1 dataVersion:(unsigned int)a2 timestamp:(double)a3;
- (BOOL)writeEventBytes:(const void *)a0 length:(unsigned long long)a1 dataVersion:(unsigned int)a2 timestamp:(double)a3 outBookmark:(id *)a4;
- (BOOL)writeEventData:(id)a0 dataVersion:(unsigned int)a1 timestamp:(double)a2;
- (BOOL)writeEventData:(id)a0 dataVersion:(unsigned int)a1 timestamp:(double)a2 outBookmark:(id *)a3;
- (BOOL)writeEventWithEventBody:(id)a0;
- (BOOL)writeEventWithEventBody:(id)a0 timestamp:(double)a1;
- (BOOL)writeEventWithEventBody:(id)a0 timestamp:(double)a1 outBookmark:(id *)a2;
- (BOOL)writeEventWithEventBody:(id)a0 timestamp:(double)a1 outEventSize:(unsigned long long *)a2 outBookmark:(id *)a3;
- (void)writeTombstoneEventWithSegmentName:(id)a0 offset:(unsigned long long)a1 length:(unsigned long long)a2 eventTimestamp:(double)a3 reason:(unsigned long long)a4 policyID:(id)a5;
- (void)writeTombstoneEventWithSegmentName:(id)a0 offset:(unsigned long long)a1 length:(unsigned long long)a2 eventTimestamp:(double)a3 reason:(unsigned long long)a4 policyID:(id)a5 outTombstoneBookmark:(id *)a6;

@end
