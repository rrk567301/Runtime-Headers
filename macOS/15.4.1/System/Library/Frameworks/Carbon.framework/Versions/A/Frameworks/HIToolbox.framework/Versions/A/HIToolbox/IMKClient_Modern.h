@class NSXPCConnection, NSString, NSArray, IMKInputSession, NSConnection, NSXPCListenerEndpoint, NSDictionary, NSRecursiveLock, NSBundle;

@interface IMKClient_Modern : NSObject <IMKClientProtocol> {
    IMKInputSession *_currentSession;
    NSString *_bundleIdentifier;
    NSBundle *_bundle;
    NSDictionary *_modes;
    NSDictionary *_inputMethodInfoDictionary;
    NSArray *localizedStrings;
    NSDictionary *_selectorDictionary;
    NSDictionary *_modeMenuKeys;
    BOOL _lookedForMenuKeys;
    struct OpaqueEventHandlerRef { } *_eventHandlerRef;
    struct __CFMessagePort { } *_launchPort;
    BOOL _isServerStarted;
    BOOL _clientHasDied;
    BOOL _getServerRetryPending;
    SEL _getServerRetryNotificationSel;
    id _getServerRetryNotificationTarget;
    long long _getServerRetryCount;
    BOOL _getServerGetMenuWasCalledDuringRetry;
    id /* block */ _tisSelectInputSourceCompletionBlock;
    id _serverDOProxy;
    NSString *_connection;
    NSString *_serverName;
    NSConnection *_serverConnection;
    NSXPCConnection *_launcherXPCConnection;
    NSXPCListenerEndpoint *_inputMethodXPCEndpoint;
    long long _exceptionTimeoutBumpCount;
    double _timeout;
    id /* block */ completionBlock;
    NSRecursiveLock *_remoteProxyLock;
}

@property BOOL cleanTermination;
@property BOOL serverDiedBadly;
@property BOOL _waitingForMenu;
@property (readonly, nonatomic, getter=isIMKExtension) BOOL isIMKExtension;

+ (struct __CFString { } *)privateRunLoopMode;
+ (struct __CFRunLoop { } *)IMKRunLoopGetMain;
+ (BOOL)isDataTracingOn;
+ (void)IMKRunLoopUpdateMain;
+ (void)IMK_Catch_Log_Stalled_PerformBlocks_DispatchTime:(double)a0 withSelector:(SEL)a1;
+ (BOOL)clientServerXPCBlockStallLogging;
+ (id)imExtensionBundlePaths;
+ (BOOL)isClientServerTracing;
+ (BOOL)isClientServerXPCTracing;
+ (BOOL)isConnectionTracing;
+ (BOOL)isGeneralDebuggingOn;
+ (void)replyWaitCount_decrementWithLocking;
+ (void)replyWaitCount_incrementWithLocking;
+ (void)replyWaitCount_lockDecrement;
+ (void)replyWaitCount_lockIncrement;
+ (int)replyWaitCount_testWithLocking;
+ (void)replyWaitCount_unlock;
+ (void)setTemporaryClientServerXPCTracing:(BOOL)a0;
+ (void)xpcSetupForMessaging;

- (void)dealloc;
- (id)bundleIdentifier;
- (struct OpaqueMenuRef { } *)menu;
- (id /* block */)completionBlock;
- (void)setCompletionBlock:(id /* block */)a0;
- (id)_bundle;
- (void)_senderIsInvalid:(id)a0;
- (id)currentSession;
- (void)setCurrentSession:(id)a0;
- (id)modes;
- (BOOL)shouldUseXPC;
- (double)_defaultTimeout;
- (BOOL)isDataTracingOn;
- (void)_addActionFrom:(id)a0 toDictionary:(id)a1 forCarbonMenu:(struct OpaqueMenuRef { } *)a2 base:(unsigned long long)a3;
- (id)_buildSelectorDictionaryFromMenuDict:(id)a0 settingCommandID:(struct OpaqueMenuRef { } *)a1;
- (void)_getServerRetry;
- (BOOL)_bumpTimeout;
- (void)_cancelGetServerRetry;
- (void)_checkSetTISCompletionBlock;
- (struct OpaqueMenuRef { } *)_createAndInstallMenuSetSelectorDictFromMenuDict:(id)a0;
- (struct OpaqueEventHandlerRef { } *)_eventHandlerRef;
- (BOOL)_getServerXPCProxyForSession:(id)a0;
- (BOOL)_haveSafeServerProxy:(id)a0;
- (id)_inputMethodInfoDictionary;
- (void)_invalidateXPCConnectionEndpoint;
- (BOOL)_isNonLaunchOption;
- (BOOL)_isPalette;
- (BOOL)_isServerRetryPending;
- (int)_launch:(id)a0 fromBundle:(id)a1 throughPort:(struct __CFMessagePort { } *)a2 usingSBExtension:(BOOL)a3;
- (struct __TISInputSource { } *)_mapKeyCodeToInputSource:(id)a0 modifiers:(id)a1;
- (void)_mapKeyCodeToInputSource:(id)a0 modifiers:(id)a1 completionHandler:(id /* block */)a2;
- (id)_modeMenuKeys;
- (void)_modeMenuKeysWithCompletionHandler:(id /* block */)a0;
- (void)_receiveXPCConnectionEndpoint:(id)a0;
- (BOOL)_requestGetServerRetryNotifyingTarget:(id)a0 withSelector:(SEL)a1;
- (id)_selectorDictionary;
- (void)_setBundleIdentifier:(id)a0;
- (void)_setEventHandlerRef:(struct OpaqueEventHandlerRef { } *)a0;
- (void)_setSelectorDictionary:(id)a0;
- (BOOL)_setTargetForServerRetry:(id)a0;
- (BOOL)_startServer_AllowingSandboxExtension:(BOOL)a0;
- (id)_targetForServerRetry;
- (double)_timeout;
- (void)_untargetFromServerRetry:(id)a0;
- (void)fulfillServerDependentWork;
- (BOOL)haveTISSelectCompletionBlock;
- (id)imageFileForName:(id)a0;
- (id)initWithBundleIdentifier:(id)a0 isIMKExtension:(BOOL)a1;
- (id)inputMethodXPCEndpoint;
- (void)invalidateIMKXPCEndpointForBundleIdentifier:(id)a0;
- (void)invalidateServerConnection;
- (BOOL)isClientServerTracing;
- (BOOL)isClientServerXPCTracing;
- (BOOL)isConnectionTracing;
- (BOOL)isGeneralDebuggingOn;
- (id)localizedStringForKey:(id)a0;
- (struct OpaqueMenuRef { } *)menuWithCompletionBlock:(id /* block */)a0;
- (void)menuWithCompletionHandler:(id /* block */)a0;
- (void)modesWithCompletionHandler:(id /* block */)a0;
- (id)remoteXPCProxyForSession:(id)a0 fromCaller:(SEL)a1;
- (void)serverWillTerminate;
- (void)setIMKXPCEndpoint:(id)a0 forBundleIdentifier:(id)a1;
- (void)setTISSelectCompletionBlock:(id /* block */)a0;
- (void)startServerSetupForEndpoint;
- (BOOL)switchedInputMode:(struct OpaqueEventRef { } *)a0;
- (void)switchedInputMode:(struct OpaqueEventRef { } *)a0 completionHandler:(id /* block */)a1;
- (id /* block */)tisSelectCompletionBlock;

@end
