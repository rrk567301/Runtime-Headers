@class MCActivityAggregate, EDPersistenceDatabaseConnection, NSString, NSArray, ACAccountStore, MCActivityMonitor, NSObject;
@protocol OS_os_log, MFLibraryUpgraderDelegate;

@interface MFLibraryUpgrader : NSObject <MCActivityTarget, MFActivityProgressUpdater> {
    EDPersistenceDatabaseConnection *_currentConnection;
    ACAccountStore *_accountStore;
    NSArray *_upgradeSteps;
}

@property (class, readonly, nonatomic) NSObject<OS_os_log> *log;

@property (retain, nonatomic) MCActivityMonitor *monitor;
@property (nonatomic) BOOL shouldRecalculateConversations;
@property (nonatomic) BOOL shouldUpdateSubjectPrefixes;
@property (nonatomic) BOOL shouldResetSnippets;
@property (nonatomic) BOOL shouldRecalculateMessageCounts;
@property (nonatomic) BOOL shouldUpdateSpotlightAttributes;
@property (nonatomic) BOOL shouldUpdateSpotlightAttributesWithMultipleRecipients;
@property (nonatomic) BOOL shouldUpdateMailboxURLs;
@property (nonatomic) BOOL shouldResetChangeIdentifierForGmailAccounts;
@property (nonatomic) BOOL shouldNormalizeMailboxPaths;
@property (nonatomic) BOOL shouldResetDynamicAccountConfiguration;
@property (nonatomic) BOOL shouldRemoveMailboxesWithAbsoluteURLs;
@property (nonatomic) BOOL shouldUpdateFavoritePersistentIDUnicodeComposition;
@property (nonatomic) BOOL shouldRemoveLocalPathsFromRulesAndSmartMailboxes;
@property (nonatomic) BOOL shouldUpdateUIDNext;
@property (nonatomic) BOOL shouldRemoveJunkColors;
@property (nonatomic) BOOL shouldReparseExchangeReferences;
@property (nonatomic) BOOL shouldRecalculateAutomatedConversations;
@property (nonatomic) unsigned long long majorVersion;
@property (nonatomic) unsigned long long minorVersion;
@property (retain, nonatomic) MCActivityAggregate *activity;
@property (nonatomic) struct sqlite3 { } *upgraderDB;
@property (readonly, nonatomic) ACAccountStore *accountStore;
@property (retain, nonatomic) EDPersistenceDatabaseConnection *currentConnection;
@property (weak, nonatomic) id<MFLibraryUpgraderDelegate> delegate;
@property (nonatomic) BOOL readOnly;
@property (readonly, nonatomic) long long libraryStatus;
@property (readonly, copy, nonatomic) NSString *displayName;
@property (readonly) unsigned long long hash;
@property (readonly) Class superclass;
@property (readonly, copy) NSString *description;
@property (readonly, copy) NSString *debugDescription;

- (void)dealloc;
- (void)run;
- (id)init;
- (void).cxx_destruct;
- (void)_executeSQL:(id)a0 updateMinorVersion:(unsigned long long)a1;
- (void)_getVersionInfo;
- (void)_sendSpotlightAttributesByPath:(id)a0;
- (void)_upgradeSchema:(id)a0;
- (void)upgradeAppleScriptFilesAndRules;
- (id)_accountsWithTypeIdentifiers:(id)a0;
- (void)_bootstrapVersioningEngine;
- (BOOL)_calculateInternationalSubjectPrefixes;
- (BOOL)_canLibraryBeUpgraded;
- (id)_copySpotlightAttributesWithDateSent:(int)a0 dateReceived:(int)a1 dateLastViewed:(int)a2 read:(int)a3 libraryFlags:(long long)a4 messageID:(const char *)a5 conversationID:(long long)a6 subject:(id)a7 displayName:(id)a8 senderName:(id)a9 senderAddress:(id)a10 recipientNames:(id)a11 recipientAddresses:(id)a12;
- (void)_createNewDatabaseObjects;
- (void)_dropTriggers;
- (void)_fakeLibraryUpgraderStep;
- (id)_fixAbsoluteMailboxURL:(id)a0 mailAccounts:(id)a1;
- (id)_fixCriteriaWithAbsoluteMailboxURLs:(id)a0 mailAccounts:(id)a1;
- (void)_fixShadowEMLXFiles;
- (void)_fixShadowEMLXFilesForAccount:(id)a0;
- (id)_fixSmartMailboxWithAbsoluteMailboxURLs:(id)a0 mailAccounts:(id)a1;
- (void)_getRecipientsForMessageWithLibraryID:(long long)a0 recipientNames:(id)a1 recipientAddresses:(id)a2 connection:(id)a3;
- (long long)_getSQLTableCount:(const char *)a0 connection:(id)a1;
- (unsigned long long)_lastWriteMinorVersion;
- (id)_libraryIDsOfAutomatedMessages;
- (BOOL)_libraryIsTooNew;
- (id)_mailboxFileSystemPathsByV1V2DatabaseURL;
- (id)_mailboxV1V2URLStringsForAccount:(id)a0;
- (BOOL)_needsRun;
- (id)_newRulesRemovingLocalPathsFromRules:(id)a0 accounts:(id)a1;
- (id)_newSmartMailboxesRemovingLocalPathsFromSmartMailboxes:(id)a0 accounts:(id)a1;
- (void)_normalizeMailboxPathComponentsInMboxCache;
- (void)_removeContainerLogs;
- (void)_removeJunkColors;
- (void)_removeLocalPathsFromRulesAndSmartMailboxes;
- (void)_removeMailboxesWithAbsoluteURLs;
- (id)_reparseExchangeReferences;
- (void)_reparseReferencesForRowIDsByMailboxURL:(id)a0;
- (void)_resetChangeIdentifierForGmailAccounts;
- (void)_resetConfigureDynamically;
- (void)_resetConversationsForExistingMessagesWithRowIDs:(id)a0;
- (void)_resetSnippetColumn;
- (void)_setSpotlightAttributesForEMLXFilesInMailbox:(id)a0 mailboxURLString:(id)a1;
- (void)_stampCurrentMinorVersion:(unsigned long long)a0;
- (void)_startMigratorServiceForAppleScriptFilesAndRules;
- (void)_startMigratorServiceForMailDownloads;
- (id)_systemAccountsWithAccountTypeIdentifiers:(id)a0;
- (void)_updateMailboxURLUnicodeComposition;
- (void)_updateSpotlightAttributes;
- (void)_updateSpotlightAttributesWithMultipleRecipients;
- (void)_updateUIDNext;
- (void)_upgradeFromMavericksToSUMavericksBoard;
- (void)_upgradeFromMountainLionToSUMountainCalypso;
- (void)_upgradeFromSUMavericksBoardToSUMavericksCarve;
- (void)_upgradeFromSUMavericksCarveToSUMavericksDune;
- (void)_upgradeFromSUMavericksDuneToYosemite;
- (void)_upgradeFromSUMountainCalypsoToMavericks;
- (void)_upgradeFromSUYosemiteDomeToElCapitan;
- (void)_upgradeFromYosemiteToSUYosemiteDome:(unsigned long long)a0;
- (id)_upgradeStepsWithConnection:(id)a0 initialLastWriteMinorVersion:(unsigned long long)a1;
- (void)_upgradeV1V2Schema;
- (id)_urlV1V2StringForMailboxDirectory:(id)a0 account:(id)a1 levelFromAccountDirectory:(unsigned long long)a2;
- (void)_useWALJournalingIfPossible;
- (void)fixMailDownloadsMigrationKey;
- (void)incrementProgressIndicator;
- (void)incrementProgressIndicatorWithThreshold:(unsigned long long)a0;
- (void)resetProgressItemsWithTotal:(unsigned long long)a0 andStatusMessage:(id)a1;
- (void)setProgressItemTotal:(unsigned long long)a0;
- (void)updateFavoritePersistentIDUnicodeComposition;
- (void)upgradeMailDataIfNecessary;
- (void)upgradeMailDownloadsFiles;

@end
